{% load static %}
<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>{% block title %}Naturalne Bransoletki{% endblock %}</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@400;500&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;500;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">


  <style>
    html { scroll-behavior: smooth; }

    .hero-background {
      background-image: url("{% static 'images/hero.png' %}");
    }
  </style>
  <style>
    html { scroll-behavior: smooth; }
  </style>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            petal: {
              50:  '#FFF9FB', // very light
              100: '#FAEAEE',
              200: '#F9E4E9',
              300: '#F8E1E7', // base
              400: '#E4BEC9', // dark-1
              500: '#D19DB1', // dark-2
            },
            primary:  '#3A3A3A',  // brƒÖz dla tekstu i CTA
            primary_darker:  '#8B3A4A',  // brƒÖz dla tekstu i CTA
            secondary:'#F8E1E7',  // kremowe t≈Ço
            dark: '#3D342F',  // ciemne t≈Ço stopki
            deeppink: '#C97C8D'
          },
          backgroundImage: {
          'petal-aurora': `
            /* softer glow on the left */
            linear-gradient(90deg,rgba(255, 249, 251, 1) 0%, rgba(250, 234, 238, 1) 50%, rgba(255, 249, 251, 1) 100%);
          `,
        },
          fontFamily: {
            sans: ['Lato', 'sans-serif'],
            playfair:['"Playfair Display"', 'serif'],
          },
        },
      },
    };
  </script>
</head>
<body class="font-sans text-primary bg-petal-aurora bg-cover bg-no-repeat">

  <!-- Header -->
  <header class="">
    <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
      <!-- Logo -->
       <a href="{% url 'home' %}" class="">
        <img src="{% static 'images/logo-main.png' %}"
        class="h-20 rounded-3xl">
       </a>

      <!-- Desktop Nav -->
      <nav class="hidden md:flex space-x-6 items-center">
        <a href="{% url 'about' %}" class="text-primary hover:text-green-700">O nas</a>
        <a href="{% url 'contact' %}" class="text-primary hover:text-green-700">Kontakt</a>
  
        <!-- Cart Dropdown -->
        <div class="relative ">
          <button id="cart-button" class="relative text-primary hover:text-green-700">
            üõí
            {% if cart_item_count > 0 %}
              <span id="cart-count" class="absolute -top-2 -right-2 bg-deeppink text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">
                {{ cart_item_count }}
              </span>
            {% endif %}
          </button>
          <div id="cart-dropdown" class="hidden absolute right-0 mt-2 w-80 bg-white border border-gray-200 rounded-3xl shadow-3xl z-50">
            <div class="p-4">
              <h3 class="text-lg  text-gray-700 mb-2">Tw√≥j koszyk</h3>
              <ul class="divide-y divide-gray-200 max-h-60 overflow-y-auto">
                {% for item in cart %}
                <li class="py-2 flex items-start justify-between">
                  <div>
                    <p class="text-sm font-medium text-primary">{{ item.product.name }}</p>
                    <p class="text-xs text-gray-500">
                      {{ item.quantity }} √ó {{ item.product.price }} z≈Ç
                    </p>
                  </div>
                  <p class="text-sm  text-gray-700 whitespace-nowrap">
                    {{ item.total_price }} z≈Ç
                  </p>
                </li>
              {% empty %}
                <p class="text-sm text-gray-500">Tw√≥j koszyk jest pusty.</p>
              {% endfor %}
              </ul>
              <div class="mt-4 flex justify-between items-center">
                <span class="text-gray-700 ">Suma: {{ cart.get_total_price }} z≈Ç</span>
                <a href="{% url 'view_cart' %}" class="bg-primary text-white px-4 py-2 rounded hover:bg-primary text-sm">Przejd≈∫ do koszyka</a>
              </div>
            </div>
          </div>
        </div>
      </nav>
  
      <!-- Hamburger Button (Mobile) -->
      <button id="mobile-menu-button" class="md:hidden text-2xl text-primary focus:outline-none">
        ‚ò∞
      </button>
    </div>
  
    <!-- Mobile Menu -->
    <div id="mobile-menu" class="hidden md:hidden px-4 pb-4 space-y-3">
      <a href="{% url 'about' %}" class="block text-primary hover:text-green-700">O nas</a>
      <a href="{% url 'contact' %}" class="block text-primary hover:text-green-700">Kontakt</a>
      <a href="{% url 'view_cart' %}" class="block text-primary hover:text-green-700">
        üõí Koszyk
      </a>
    </div>
  </header>

  <!-- Page content -->
  <main class="min-h-screen">
    {% if messages %}
      <div class="mb-6 max-w-3xl mx-auto text-center">
        {% for message in messages %}
          <p class="text-sm {% if message.tags == 'success' %}text-green-700{% elif message.tags == 'error' %}text-red-600{% else %}text-primary{% endif %}">
            {{ message }}
          </p>
        {% endfor %}
      </div>
    {% endif %}
    {% block content %}{% endblock %}
  </main>

  <!-- Footer -->
<!-- Polished footer -->
<footer class="py-12 bg-secondary text-dark ">
  <div class="max-w-6xl mx-auto px-6 grid gap-10 md:grid-cols-2 lg:grid-cols-3">
    <!-- column 1 -->
    <div>
      <p class="font-playfair text-lg text-dark mb-3">Naturalne Bransoletki</p>
      <p class="text-sm leading-relaxed">
        Rƒôcznie wiƒÖzane sznurki, prawdziwe kamienie. Tworzymy bi≈ºuteriƒô, kt√≥ra
        nosi TwojƒÖ historiƒô.
      </p>
    </div>

    <!-- column 2 -->
    <nav class="flex flex-col space-y-2">
      <a href="#" class="hover:text-white transition">Regulamin</a>
      <a href="#" class="hover:text-white transition">Polityka prywatno≈õci</a>
      <a href="#" class="hover:text-white transition">FAQ</a>
    </nav>

    <!-- column 3 / socials -->
    <div class="flex items-center md:justify-end space-x-4">
      <a href="#" aria-label="Facebook"
         class="p-2 rounded-full bg-white/10 hover:bg-white/20 transition">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5"
             fill="currentColor" viewBox="0 0 24 24">
          <path d="M22 12a10 10 0 10-11.6 9.9v-7H8v-2.9h2.4V9.2c0-2.4 1.44-3.8 3.64-3.8
                   1.06 0 2.17.19 2.17.19v2.4h-1.22c-1.2 0-1.57.75-1.57 1.52v1.83H18
                   l-.32 2.9h-2.37v7A10 10 0 0022 12z"/>
        </svg>
      </a>
      <a href="#" aria-label="Instagram"
         class="p-2 rounded-full bg-white/10 hover:bg-white/20 transition">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5"
             fill="currentColor" viewBox="0 0 24 24">
          <path d="M7 2h10a5 5 0 015 5v10a5 5 0 01-5 5H7a5 5 0 01-5-5V7
                   a5 5 0 015-5zm5 4.9a5.1 5.1 0 100 10.2 5.1 5.1 0 000-10.2zm6.4-.2
                   a1.2 1.2 0 11-2.4 0 1.2 1.2 0 012.4 0zM12 9.6a2.4 2.4 0 110 4.8
                   2.4 2.4 0 010-4.8z"/>
        </svg>
      </a>
    </div>
  </div>

  <p class="mt-8 text-center text-xs text-dark">
    &copy; 2025 Naturalne Bransoletki. Wszelkie prawa zastrze≈ºone.
  </p>
</footer>

<!-- Add to Cart Confirmation Modal -->
<div id="add-to-cart-popup" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
  <div class="bg-secondary p-6 rounded-lg shadow-lg text-center max-w-md w-full mx-4">
    <h2 class="text-lg  text-green-700 mb-2">Produkt zosta≈Ç dodany do koszyka</h2>
    <p id="popup-product-name" class="text-primary "></p>
    <p id="popup-product-price" class="text-sm text-primary mb-4"></p>
    <div class="flex justify-center gap-4">
      <button id="continue-shopping-btn" class="px-4 py-2 bg-gray-200 rounded hover:bg-gray-300">Kontynuuj zakupy</button>
      <a href="{% url 'view_cart' %}" class="px-4 py-2 bg-primary text-white rounded hover:bg-primary">Przejd≈∫ do koszyka</a>
    </div>
  </div>
</div>


    <script>
    document.addEventListener('DOMContentLoaded', function () {
        const cartButton = document.getElementById('cart-button');
        const cartDropdown = document.getElementById('cart-dropdown');

        cartButton.addEventListener('click', function (e) {
        e.stopPropagation();
        cartDropdown.classList.toggle('hidden');
        });

        document.addEventListener('click', function (e) {
        if (!cartDropdown.contains(e.target) && !cartButton.contains(e.target)) {
            cartDropdown.classList.add('hidden');
        }
        });
    });
    </script>

    <script>
      // Function to show the add-to-cart modal with product details
      function showAddToCartModal(product) {
        document.getElementById('modal-product-image').src = product.image_url;
        document.getElementById('modal-product-name').textContent = product.name;
        document.getElementById('modal-product-quantity').textContent = `${product.quantity} szt.`;
        document.getElementById('modal-product-price').textContent = `${product.price} z≈Ç`;

        document.getElementById('add-to-cart-modal').classList.remove('hidden');
      }

      // Event listener for 'Continue Shopping' button
      document.getElementById('continue-shopping').addEventListener('click', function() {
        document.getElementById('add-to-cart-modal').classList.add('hidden');
      });
    </script>

    <script>
      document.querySelectorAll('.add-to-cart-btn').forEach(button => {
      button.addEventListener('click', function () {
        const productId = this.dataset.productId;
        const productName = this.dataset.productName;
        const productPrice = this.dataset.productPrice;
        const csrfToken = this.dataset.csrf;

        fetch(`/cart/add/${productId}/`, {
          method: 'POST',
          headers: {
            'X-CSRFToken': csrfToken,
            'X-Requested-With': 'XMLHttpRequest',
          },
        })
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            // Show popup content
            document.getElementById('popup-product-name').textContent = productName;
            document.getElementById('popup-product-price').textContent = `1 szt. x ${productPrice} z≈Ç`;
            document.getElementById('add-to-cart-popup').classList.remove('hidden');

            // Update cart count
            const badge = document.getElementById('cart-count');
            if (badge) {
              badge.classList.remove('hidden');
              badge.textContent = data.cart_item_count;
            }
          }
        });
      });
    });

    document.getElementById('continue-shopping-btn')?.addEventListener('click', () => {
      document.getElementById('add-to-cart-popup')?.classList.add('hidden');
    });

    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');

    mobileMenuButton.addEventListener('click', () => {
      mobileMenu.classList.toggle('hidden');
    });
    </script>

  {% block extra_scripts %}
  {% endblock %}

  

</body>
</html>
