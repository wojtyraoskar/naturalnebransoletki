{% load static %}
<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>{% block title %}Naturalne Bransoletki{% endblock %}</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    html { scroll-behavior: smooth; }

    .hero-background {
      background-image: url("{% static 'images/hero.png' %}");
    }
  </style>
  <style>
    html { scroll-behavior: smooth; }
  </style>
</head>
<body class="bg-white text-gray-800">

  <!-- Header -->
  <header class="bg-white shadow-md">
    <div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
      <!-- Logo -->
      <a href="{% url 'home' %}" class="text-xl font-semibold text-green-700">Naturalne Bransoletki</a>
  
      <!-- Desktop Nav -->
      <nav class="hidden md:flex space-x-6 items-center">
        <a href="{% url 'home' %}" class="text-gray-600 hover:text-green-700">Strona G≈Ç√≥wna</a>
        <a href="{% url 'about' %}" class="text-gray-600 hover:text-green-700">O nas</a>
        <a href="{% url 'contact' %}" class="text-gray-600 hover:text-green-700">Kontakt</a>
  
        <!-- Cart Dropdown -->
        <div class="relative">
          <button id="cart-button" class="relative text-gray-600 hover:text-green-700">
            üõí
            {% if cart_item_count > 0 %}
              <span id="cart-count" class="absolute -top-2 -right-2 bg-green-600 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">
                {{ cart_item_count }}
              </span>
            {% endif %}
          </button>
          <div id="cart-dropdown" class="hidden absolute right-0 mt-2 w-80 bg-white border border-gray-200 rounded shadow-lg z-50">
            <div class="p-4">
              <h3 class="text-lg font-semibold text-gray-700 mb-2">Tw√≥j koszyk</h3>
              <ul class="divide-y divide-gray-200 max-h-60 overflow-y-auto">
                {% for item in cart %}
                <li class="py-2 flex items-start justify-between">
                  <div>
                    <p class="text-sm font-medium text-gray-800">{{ item.product.name }}</p>
                    <p class="text-xs text-gray-500">
                      {{ item.quantity }} √ó {{ item.product.price }} z≈Ç
                    </p>
                  </div>
                  <p class="text-sm font-semibold text-gray-700 whitespace-nowrap">
                    {{ item.total_price }} z≈Ç
                  </p>
                </li>
              {% empty %}
                <p class="text-sm text-gray-500">Tw√≥j koszyk jest pusty.</p>
              {% endfor %}
              </ul>
              <div class="mt-4 flex justify-between items-center">
                <span class="text-gray-700 font-semibold">Suma: {{ cart.get_total_price }} z≈Ç</span>
                <a href="{% url 'view_cart' %}" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 text-sm">Przejd≈∫ do koszyka</a>
              </div>
            </div>
          </div>
        </div>
      </nav>
  
      <!-- Hamburger Button (Mobile) -->
      <button id="mobile-menu-button" class="md:hidden text-2xl text-gray-600 focus:outline-none">
        ‚ò∞
      </button>
    </div>
  
    <!-- Mobile Menu -->
    <div id="mobile-menu" class="hidden md:hidden px-4 pb-4 space-y-3">
      <a href="{% url 'home' %}" class="block text-gray-600 hover:text-green-700">Strona G≈Ç√≥wna</a>
      <a href="{% url 'about' %}" class="block text-gray-600 hover:text-green-700">O nas</a>
      <a href="{% url 'contact' %}" class="block text-gray-600 hover:text-green-700">Kontakt</a>
      <a href="{% url 'view_cart' %}" class="block text-gray-600 hover:text-green-700">
        üõí Koszyk
      </a>
    </div>
  </header>

  <!-- Page content -->
  <main class="min-h-screen">
    {% if messages %}
      <div class="mb-6 max-w-3xl mx-auto text-center">
        {% for message in messages %}
          <p class="text-sm {% if message.tags == 'success' %}text-green-700{% elif message.tags == 'error' %}text-red-600{% else %}text-gray-600{% endif %}">
            {{ message }}
          </p>
        {% endfor %}
      </div>
    {% endif %}
    {% block content %}{% endblock %}
  </main>

  <!-- Footer -->
  <footer class="bg-gray-50 py-8 mt-16">
    <div class="max-w-7xl mx-auto px-4 flex flex-col md:flex-row justify-between items-center text-sm text-gray-600">
      <p>&copy; 2025 Naturalne Bransoletki. Wszelkie prawa zastrze≈ºone.</p>
      <div class="flex space-x-4 mt-4 md:mt-0">
        <a href="#">Facebook</a>
        <a href="#">Instagram</a>
        <a href="#">Regulamin</a>
        <a href="#">Polityka prywatno≈õci</a>
      </div>
    </div>
  </footer>

<!-- Add to Cart Confirmation Modal -->
<div id="add-to-cart-popup" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
  <div class="bg-white p-6 rounded-lg shadow-lg text-center max-w-md w-full mx-4">
    <h2 class="text-lg font-semibold text-green-700 mb-2">Produkt zosta≈Ç dodany do koszyka</h2>
    <p id="popup-product-name" class="text-gray-800 font-semibold"></p>
    <p id="popup-product-price" class="text-sm text-gray-600 mb-4"></p>
    <div class="flex justify-center gap-4">
      <button id="continue-shopping-btn" class="px-4 py-2 bg-gray-200 rounded hover:bg-gray-300">Kontynuuj zakupy</button>
      <a href="{% url 'view_cart' %}" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700">Przejd≈∫ do koszyka</a>
    </div>
  </div>
</div>


    <script>
    document.addEventListener('DOMContentLoaded', function () {
        const cartButton = document.getElementById('cart-button');
        const cartDropdown = document.getElementById('cart-dropdown');

        cartButton.addEventListener('click', function (e) {
        e.stopPropagation();
        cartDropdown.classList.toggle('hidden');
        });

        document.addEventListener('click', function (e) {
        if (!cartDropdown.contains(e.target) && !cartButton.contains(e.target)) {
            cartDropdown.classList.add('hidden');
        }
        });
    });
    </script>

    <script>
      // Function to show the add-to-cart modal with product details
      function showAddToCartModal(product) {
        document.getElementById('modal-product-image').src = product.image_url;
        document.getElementById('modal-product-name').textContent = product.name;
        document.getElementById('modal-product-quantity').textContent = `${product.quantity} szt.`;
        document.getElementById('modal-product-price').textContent = `${product.price} z≈Ç`;

        document.getElementById('add-to-cart-modal').classList.remove('hidden');
      }

      // Event listener for 'Continue Shopping' button
      document.getElementById('continue-shopping').addEventListener('click', function() {
        document.getElementById('add-to-cart-modal').classList.add('hidden');
      });
    </script>

    <script>
      document.querySelectorAll('.add-to-cart-btn').forEach(button => {
      button.addEventListener('click', function () {
        const productId = this.dataset.productId;
        const productName = this.dataset.productName;
        const productPrice = this.dataset.productPrice;
        const csrfToken = this.dataset.csrf;

        fetch(`/cart/add/${productId}/`, {
          method: 'POST',
          headers: {
            'X-CSRFToken': csrfToken,
            'X-Requested-With': 'XMLHttpRequest',
          },
        })
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            // Show popup content
            document.getElementById('popup-product-name').textContent = productName;
            document.getElementById('popup-product-price').textContent = `1 szt. x ${productPrice} z≈Ç`;
            document.getElementById('add-to-cart-popup').classList.remove('hidden');

            // Update cart count
            const badge = document.getElementById('cart-count');
            if (badge) {
              badge.classList.remove('hidden');
              badge.textContent = data.cart_item_count;
            }
          }
        });
      });
    });

    document.getElementById('continue-shopping-btn')?.addEventListener('click', () => {
      document.getElementById('add-to-cart-popup')?.classList.add('hidden');
    });

    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');

    mobileMenuButton.addEventListener('click', () => {
      mobileMenu.classList.toggle('hidden');
    });
    </script>

  {% block extra_scripts %}
  {% endblock %}

  

</body>
</html>
